!function(e){var t={};function n(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){n(2),e.exports=n(1)},function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/styles/app.min.css"},function(e,t,n){"use strict";function s(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}n.r(t);var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.steps={},this.sunsetAngle=15,this.nightAngle=0,this.sunriseAngle=-15}var t,n,i;return t=e,(n=[{key:"init",value:function(e){this.steps=e}},{key:"rotateWheel",value:function(e){console.log(window.screen),e>=this.steps.sunriseStep?window.screen.availWidth>=1024?document.documentElement.style.setProperty("--wheel-rotation",this.sunriseAngle+90+"deg"):document.documentElement.style.setProperty("--wheel-rotation",this.sunriseAngle+"deg"):e>=this.steps.sunsetStep?(window.screen.availWidth>=1024?document.documentElement.style.setProperty("--wheel-rotation",this.nightAngle+90+"deg"):document.documentElement.style.setProperty("--wheel-rotation",this.nightAngle+"deg"),console.log("night")):(window.screen.availWidth>=1024?document.documentElement.style.setProperty("--wheel-rotation",this.sunsetAngle+90+"deg"):document.documentElement.style.setProperty("--wheel-rotation",this.sunsetAngle+"deg"),console.log("sunset"))}},{key:"nightRotation",value:function(){window.screen.availWidth>=1024?document.documentElement.style.setProperty("--wheel-rotation",this.nightAngle+90+"deg"):document.documentElement.style.setProperty("--wheel-rotation",this.nightAngle+"deg")}},{key:"sunsetRotation",value:function(){window.screen.availWidth>=1024?document.documentElement.style.setProperty("--wheel-rotation",this.sunsetAngle+90+"deg"):document.documentElement.style.setProperty("--wheel-rotation",this.sunsetAngle+"deg")}},{key:"sunriseRotation",value:function(){window.screen.availWidth>=1024?document.documentElement.style.setProperty("--wheel-rotation",this.sunriseAngle+90+"deg"):document.documentElement.style.setProperty("--wheel-rotation",this.sunriseAngle+"deg")}}])&&s(t.prototype,n),i&&s(t,i),e}();function o(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lat="50.8466",this.lng="4.3528",this.apiURL="https://api.sunrise-sunset.org/json?lat="+this.lat+"&lng="+this.lng+"&formatted=0",this.containerHTML=document.querySelector(".js-background"),this.onePartHeight=document.body.clientHeight/24,this.sunsetHours=19,this.sunriseHours=4,this.sunsetStep=this.sunsetHours*this.onePartHeight,this.sunriseStep=this.sunriseHours*this.onePartHeight,this.cycleWheel=t}var t,n,s;return t=e,(n=[{key:"init",value:function(){this.setLatLng(),this.setResizeEventListener();var e=this;fetch(this.apiURL).then((function(e){return e.json()})).then((function(t){console.log(t);var n=t.results.sunrise;e.sunriseHours=24-e.getHours(new Date(n));var s=t.results.sunset;e.sunsetHours=24-e.getHours(new Date(s)),e.sunriseStep=e.sunriseHours*e.onePartHeight,e.sunsetStep=e.sunsetHours*e.onePartHeight,e.cycleWheel.init({sunsetStep:e.sunsetStep,sunriseStep:e.sunriseStep}),e.setNightOrDay(window.pageYOffset+window.innerHeight/2),e.cycleWheel.rotateWheel(window.pageYOffset+window.innerHeight/2),console.log(e.sunriseHours,e.sunriseStep,e.sunsetHours,e.sunsetStep),e.setScrollEventListener()})).catch((function(t){console.error("Il y a eu un problÃ¨me lors de l'excecution du Fetch : "+t),e.cycleWheel.init({sunsetStep:e.sunsetStep,sunriseStep:e.sunriseStep}),e.setNightOrDay(window.pageYOffset+window.innerHeight/2),e.cycleWheel.rotateWheel(window.pageYOffset+window.innerHeight/2),e.setScrollEventListener()}))}},{key:"setLatLng",value:function(){var e=this;"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((function(t){e.lat=t.coords.latitude,e.lng=t.coords.longitude}))}},{key:"setNightOrDay",value:function(e){e>=this.sunriseStep?(console.log("day"),this.containerHTML.classList.add("js-sunrise"),document.documentElement.style.setProperty("--color-text","#2B2B2B"),this.cycleWheel.sunriseRotation(),this.containerHTML.classList.remove("js-night")):e>=this.sunsetStep?(console.log("night"),this.containerHTML.classList.add("js-night"),document.documentElement.style.setProperty("--color-text","#F7F7F7"),this.cycleWheel.nightRotation(),this.containerHTML.classList.remove("js-sunset"),this.containerHTML.classList.remove("js-sunrise")):(console.log("day"),this.containerHTML.classList.add("js-sunset"),document.documentElement.style.setProperty("--color-text","#2B2B2B"),this.cycleWheel.sunsetRotation(),this.containerHTML.classList.remove("js-night"))}},{key:"setResizeEventListener",value:function(){var e=this;window.addEventListener("resize",(function(t){setTimeout(e.resizeFunction(),250)}))}},{key:"setScrollEventListener",value:function(){var e=this;window.addEventListener("scroll",(function(t){e.setNightOrDay(window.pageYOffset+window.innerHeight/2)}))}},{key:"resizeFunction",value:function(){this.onePartHeight=document.body.clientHeight/24,this.sunriseStep=this.sunriseHours*this.onePartHeight,this.sunsetStep=this.sunsetHours*this.onePartHeight}},{key:"getHours",value:function(e){var t=e.getUTCHours();return e.getUTCMinutes()>=40?t+1:t}}])&&o(t.prototype,n),s&&o(t,s),e}())(new i).init()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Fzc2V0cy9zYXNzL2FwcC5zY3NzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL0N5Y2xlV2hlZWwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL1NreUJhY2tncm91bmQuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJDeWNsZVdoZWVsIiwidGhpcyIsInN0ZXBzIiwic3Vuc2V0QW5nbGUiLCJuaWdodEFuZ2xlIiwic3VucmlzZUFuZ2xlIiwicG9zaXRpb24iLCJjb25zb2xlIiwibG9nIiwid2luZG93Iiwic2NyZWVuIiwic3VucmlzZVN0ZXAiLCJhdmFpbFdpZHRoIiwiZG9jdW1lbnQiLCJkb2N1bWVudEVsZW1lbnQiLCJzdHlsZSIsInNldFByb3BlcnR5Iiwic3Vuc2V0U3RlcCIsImN5Y2xlV2hlZWwiLCJsYXQiLCJsbmciLCJhcGlVUkwiLCJjb250YWluZXJIVE1MIiwicXVlcnlTZWxlY3RvciIsIm9uZVBhcnRIZWlnaHQiLCJib2R5IiwiY2xpZW50SGVpZ2h0Iiwic3Vuc2V0SG91cnMiLCJzdW5yaXNlSG91cnMiLCJzZXRMYXRMbmciLCJzZXRSZXNpemVFdmVudExpc3RlbmVyIiwidGhhdCIsImZldGNoIiwidGhlbiIsInJlc3BvbnNlIiwianNvbiIsInN1bnJpc2UiLCJyZXN1bHRzIiwiZ2V0SG91cnMiLCJEYXRlIiwic3Vuc2V0IiwiaW5pdCIsInNldE5pZ2h0T3JEYXkiLCJwYWdlWU9mZnNldCIsImlubmVySGVpZ2h0Iiwicm90YXRlV2hlZWwiLCJzZXRTY3JvbGxFdmVudExpc3RlbmVyIiwiZXJyb3IiLCJuYXZpZ2F0b3IiLCJnZW9sb2NhdGlvbiIsImdldEN1cnJlbnRQb3NpdGlvbiIsImNvb3JkcyIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiY2xhc3NMaXN0IiwiYWRkIiwic3VucmlzZVJvdGF0aW9uIiwicmVtb3ZlIiwibmlnaHRSb3RhdGlvbiIsInN1bnNldFJvdGF0aW9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJzZXRUaW1lb3V0IiwicmVzaXplRnVuY3Rpb24iLCJkYXRlIiwiaG91cnMiLCJnZXRVVENIb3VycyIsImdldFVUQ01pbnV0ZXMiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhp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V0FFM0RmLEtBQUtpQixXQUFXeUMsaUJBR2hCMUQsS0FBS3FCLGNBQWNnQyxVQUFVRyxPQUFPLGUsK0NBU3hDLElBQU0xQixFQUFPOUIsS0FDYlEsT0FBT21ELGlCQUFpQixVQUFVLFNBQUNDLEdBRy9CQyxXQUFXL0IsRUFBS2dDLGlCQUFrQixVLCtDQVFqQixXQUdyQnRELE9BQU9tRCxpQkFBaUIsVUFBVSxTQUFDQyxHQUcvQixFQUFLbkIsY0FBY2pDLE9BQU9rQyxZQUFlbEMsT0FBT21DLFlBQVksUSx1Q0FRaEUzQyxLQUFLdUIsY0FBaUJYLFNBQVNZLEtBQUtDLGFBQWdCLEdBQ3BEekIsS0FBS1UsWUFBY1YsS0FBSzJCLGFBQWUzQixLQUFLdUIsY0FDNUN2QixLQUFLZ0IsV0FBYWhCLEtBQUswQixZQUFjMUIsS0FBS3VCLGdCLCtCQVNyQ3dDLEdBQ0wsSUFBTUMsRUFBUUQsRUFBS0UsY0FFbkIsT0FEZ0JGLEVBQUtHLGlCQUNQLEdBQ0hGLEVBQVEsRUFFWkEsTyxnQ0R4TUssQ0FBa0IsSUFBSWpFLEdBQWN5QyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZXhwb3J0IGRlZmF1bHQgX193ZWJwYWNrX3B1YmxpY19wYXRoX18gKyBcImFzc2V0cy9zdHlsZXMvYXBwLm1pbi5jc3NcIjsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDeWNsZVdoZWVsIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5zdGVwcyA9IHt9O1xuXG4gICAgICAgIC8vIEFuZ2xlcyBkZXBlbmRpbmcgb2YgdGhlIHBhcnRcbiAgICAgICAgLy8gb2YgdGhlIGRheVxuICAgICAgICB0aGlzLnN1bnNldEFuZ2xlID0gMTU7XG4gICAgICAgIHRoaXMubmlnaHRBbmdsZSA9IDA7XG4gICAgICAgIHRoaXMuc3VucmlzZUFuZ2xlID0gLTE1O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgc3RlcHMgb2YgdGhlIGluc3RhbmNlXG4gICAgICogXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHN0ZXBzIFxuICAgICAqL1xuICAgIGluaXQoc3RlcHMpIHtcbiAgICAgICAgdGhpcy5zdGVwcyA9IHN0ZXBzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoYW5nZSB0aGUgYW5nbGUgcm90YXRpb24gZGVwZW5kaW5nIG9mXG4gICAgICogdGhlIHBhcnQgb2YgdGhlIGRheVxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7ZmxvYXR9IHBvc2l0aW9uIFxuICAgICAqL1xuICAgIHJvdGF0ZVdoZWVsKHBvc2l0aW9uKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHdpbmRvdy5zY3JlZW4pO1xuICAgICAgICBpZihwb3NpdGlvbiA+PSB0aGlzLnN0ZXBzLnN1bnJpc2VTdGVwKSB7XG4gICAgICAgICAgICAvLyBDaGFuZ2UgYW5nbGVcbiAgICAgICAgICAgIC8vIGRlcGVuZGluZyBvZiB0aGUgc2l6ZSBvZiB0aGUgc2NyZWVuXG4gICAgICAgICAgICB3aW5kb3cuc2NyZWVuLmF2YWlsV2lkdGggPj0gMTAyNCA/IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS13aGVlbC1yb3RhdGlvbicsICh0aGlzLnN1bnJpc2VBbmdsZSs5MCkgKyAnZGVnJykgOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0td2hlZWwtcm90YXRpb24nLCB0aGlzLnN1bnJpc2VBbmdsZSArICdkZWcnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHBvc2l0aW9uID49IHRoaXMuc3RlcHMuc3Vuc2V0U3RlcCkge1xuICAgICAgICAgICAgLy8gQ2hhbmdlIGFuZ2xlXG4gICAgICAgICAgICB3aW5kb3cuc2NyZWVuLmF2YWlsV2lkdGggPj0gMTAyNCA/IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS13aGVlbC1yb3RhdGlvbicsICh0aGlzLm5pZ2h0QW5nbGUrOTApICsgJ2RlZycpIDogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXdoZWVsLXJvdGF0aW9uJywgdGhpcy5uaWdodEFuZ2xlICsgJ2RlZycpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ25pZ2h0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBDaGFuZ2UgYW5nbGVcbiAgICAgICAgICAgIHdpbmRvdy5zY3JlZW4uYXZhaWxXaWR0aCA+PSAxMDI0ID8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXdoZWVsLXJvdGF0aW9uJywgKHRoaXMuc3Vuc2V0QW5nbGUrOTApICsgJ2RlZycpIDogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXdoZWVsLXJvdGF0aW9uJywgdGhpcy5zdW5zZXRBbmdsZSArICdkZWcnKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdW5zZXQnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5pZ2h0Um90YXRpb24oKSB7XG4gICAgICAgIHdpbmRvdy5zY3JlZW4uYXZhaWxXaWR0aCA+PSAxMDI0ID8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXdoZWVsLXJvdGF0aW9uJywgKHRoaXMubmlnaHRBbmdsZSs5MCkgKyAnZGVnJykgOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0td2hlZWwtcm90YXRpb24nLCB0aGlzLm5pZ2h0QW5nbGUgKyAnZGVnJyk7XG4gICAgfVxuICAgIHN1bnNldFJvdGF0aW9uKCkge1xuICAgICAgICB3aW5kb3cuc2NyZWVuLmF2YWlsV2lkdGggPj0gMTAyNCA/IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS13aGVlbC1yb3RhdGlvbicsICh0aGlzLnN1bnNldEFuZ2xlKzkwKSArICdkZWcnKSA6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS13aGVlbC1yb3RhdGlvbicsIHRoaXMuc3Vuc2V0QW5nbGUgKyAnZGVnJyk7XG4gICAgfVxuICAgIHN1bnJpc2VSb3RhdGlvbigpIHtcbiAgICAgICAgd2luZG93LnNjcmVlbi5hdmFpbFdpZHRoID49IDEwMjQgPyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0td2hlZWwtcm90YXRpb24nLCAodGhpcy5zdW5yaXNlQW5nbGUrOTApICsgJ2RlZycpIDogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXdoZWVsLXJvdGF0aW9uJywgdGhpcy5zdW5yaXNlQW5nbGUgKyAnZGVnJyk7XG4gICAgfVxufSIsImltcG9ydCBDeWNsZVdoZWVsIGZyb20gJy4vY29tcG9uZW50cy9DeWNsZVdoZWVsJztcbmltcG9ydCBTa3lCYWNrZ3JvdW5kIGZyb20gJy4vY29tcG9uZW50cy9Ta3lCYWNrZ3JvdW5kJztcblxubGV0IHNreUJhY2tncm91bmQgPSBuZXcgU2t5QmFja2dyb3VuZChuZXcgQ3ljbGVXaGVlbCgpKS5pbml0KCk7IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2t5QmFja2dyb3VuZCB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtDeWNsZVdoZWVsfSBjeWNsZVdoZWVsIFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGN5Y2xlV2hlZWwpIHtcbiAgICAgICAgLy8gTGF0aXR1ZGUgYW5kIGxvbmdpdHVkZSBvZiBCcnVzc2VscyBieSBkZWZhdWx0XG4gICAgICAgIHRoaXMubGF0ID0gJzUwLjg0NjYnO1xuICAgICAgICB0aGlzLmxuZyA9ICc0LjM1MjgnO1xuXG4gICAgICAgIC8vIEZyb20gdGhpcyBBUEkgOiBodHRwczovL3N1bnJpc2Utc3Vuc2V0Lm9yZy9hcGlcbiAgICAgICAgLy8gZm9ybWF0dGVkPTAgdG8gdHJhbnNmb3JtIHRoZSBkYXRhIGludG8gRGF0ZSBvYmplY3RzXG4gICAgICAgIHRoaXMuYXBpVVJMID0gJ2h0dHBzOi8vYXBpLnN1bnJpc2Utc3Vuc2V0Lm9yZy9qc29uP2xhdD0nICsgdGhpcy5sYXQgKyAnJmxuZz0nICsgdGhpcy5sbmcgKyAnJmZvcm1hdHRlZD0wJztcblxuICAgICAgICAvLyBUaGUgSFRNTCBvYmplY3Qgb24gd2hpY2ggdGhlIGJhY2tncm91bmQgd2lsbCBjaGFuZ2VcbiAgICAgICAgdGhpcy5jb250YWluZXJIVE1MID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLWJhY2tncm91bmQnKTtcblxuICAgICAgICAvLyBUaGUgbWVhc3VyZSBvZiAxLzI0IG9mIHRoZSBoZWlnaHQgb2YgdGhlIHNpdGVcbiAgICAgICAgdGhpcy5vbmVQYXJ0SGVpZ2h0ID0gKGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0KSAvIDI0O1xuXG4gICAgICAgIC8vIEhvdXJzIHdoZW4gdGhlIHN1biByaXNlcyBhbmQgc2V0c1xuICAgICAgICAvLyBEYXRhIGZyb20gQnJ1c3NlbHMgYnkgZGVmYXVsdFxuICAgICAgICB0aGlzLnN1bnNldEhvdXJzID0gMTk7XG4gICAgICAgIHRoaXMuc3VucmlzZUhvdXJzID0gNDtcbiAgICAgICAgLy8gVmFsdWVzIG9mIHdoZW4gdGhlIHN1biByaXNlcyBhbmQgc2V0c1xuICAgICAgICAvLyBpbiBmdW5jdGlvbiBvZiB0aGUgaGVpZ2h0IG9mIHRoZSBib2R5XG4gICAgICAgIC8vIERhdGEgZnJvbSBCcnVzc2VscyBieSBkZWZhdWx0XG4gICAgICAgIHRoaXMuc3Vuc2V0U3RlcCA9IHRoaXMuc3Vuc2V0SG91cnMgKiB0aGlzLm9uZVBhcnRIZWlnaHQ7XG4gICAgICAgIHRoaXMuc3VucmlzZVN0ZXAgPSB0aGlzLnN1bnJpc2VIb3VycyAqIHRoaXMub25lUGFydEhlaWdodDtcblxuICAgICAgICAvLyBUaGUgQ3ljbGVXaGVlbCBvYmplY3RcbiAgICAgICAgdGhpcy5jeWNsZVdoZWVsID0gY3ljbGVXaGVlbDtcbiAgICB9XG5cbiAgICBpbml0KCkge1xuICAgICAgICAvLyBTZXQgdGhlIGxhdGl0dWRlIGFuZCBsb25naXR1ZGVcbiAgICAgICAgdGhpcy5zZXRMYXRMbmcoKTtcbiAgICAgICAgLy8gQWRkIGFuIGV2ZW50IGxpc3RlbmVyIG9uIHRoZSB3aW5kb3cgcmVzaXplXG4gICAgICAgIHRoaXMuc2V0UmVzaXplRXZlbnRMaXN0ZW5lcigpO1xuICAgICAgICBcbiAgICAgICAgLyogRkVUQ0ggKi9cbiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXM7XG4gICAgICAgIGZldGNoKHRoaXMuYXBpVVJMKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihqc29uKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coanNvbik7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3VucmlzZSA9IGpzb24ucmVzdWx0cy5zdW5yaXNlO1xuICAgICAgICAgICAgICAgIC8vIFRoZSB3ZWJzaXRlIGVuZHMgYnkgdGhlIHN1bnJpc2Ugc28gdGhlXG4gICAgICAgICAgICAgICAgLy8gaG91cnMgd2lsbCBiZSByZXZlcnNlXG4gICAgICAgICAgICAgICAgdGhhdC5zdW5yaXNlSG91cnMgPSAyNCAtIHRoYXQuZ2V0SG91cnMobmV3IERhdGUoc3VucmlzZSkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHN1bnNldCA9IGpzb24ucmVzdWx0cy5zdW5zZXQ7XG4gICAgICAgICAgICAgICAgLy8gVGhlIHdlYnNpdGUgYmVnaW5zIGJ5IHRoZSBzdW5zZXQgc28gdGhlXG4gICAgICAgICAgICAgICAgLy8gaG91cnMgd2lsbCBiZSByZXZlcnNlXG4gICAgICAgICAgICAgICAgdGhhdC5zdW5zZXRIb3VycyA9IDI0IC0gdGhhdC5nZXRIb3VycyhuZXcgRGF0ZShzdW5zZXQpKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoYXQuc3VucmlzZVN0ZXAgPSB0aGF0LnN1bnJpc2VIb3VycyAqIHRoYXQub25lUGFydEhlaWdodDtcbiAgICAgICAgICAgICAgICB0aGF0LnN1bnNldFN0ZXAgPSB0aGF0LnN1bnNldEhvdXJzICogdGhhdC5vbmVQYXJ0SGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgLy8gSW5pdCB0aGUgY3ljbGVXaGVlbFxuICAgICAgICAgICAgICAgIHRoYXQuY3ljbGVXaGVlbC5pbml0KHtcbiAgICAgICAgICAgICAgICAgICAgc3Vuc2V0U3RlcDogdGhhdC5zdW5zZXRTdGVwLFxuICAgICAgICAgICAgICAgICAgICBzdW5yaXNlU3RlcDogdGhhdC5zdW5yaXNlU3RlcFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gSW5pdCB0aGUgcG9zaXRpb25cbiAgICAgICAgICAgICAgICB0aGF0LnNldE5pZ2h0T3JEYXkod2luZG93LnBhZ2VZT2Zmc2V0ICsgKHdpbmRvdy5pbm5lckhlaWdodC8yKSk7XG4gICAgICAgICAgICAgICAgdGhhdC5jeWNsZVdoZWVsLnJvdGF0ZVdoZWVsKHdpbmRvdy5wYWdlWU9mZnNldCArICh3aW5kb3cuaW5uZXJIZWlnaHQvMikpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhhdC5zdW5yaXNlSG91cnMsIHRoYXQuc3VucmlzZVN0ZXAsIHRoYXQuc3Vuc2V0SG91cnMsIHRoYXQuc3Vuc2V0U3RlcCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGF0LnNldFNjcm9sbEV2ZW50TGlzdGVuZXIoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvLyBJZiB0aGUgRmV0Y2ggZmFpbHNcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgIC8vIERpc3BsYXkgdGhlIGVycm9yIGluIHRoZSBjb25zb2xlXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignSWwgeSBhIGV1IHVuIHByb2Jsw6htZSBsb3JzIGRlIGxcXCdleGNlY3V0aW9uIGR1IEZldGNoIDogJyArIGVycm9yKTtcblxuICAgICAgICAgICAgICAgIC8vIEluaXQgdGhlIGN5Y2xlV2hlZWxcbiAgICAgICAgICAgICAgICB0aGF0LmN5Y2xlV2hlZWwuaW5pdCh7XG4gICAgICAgICAgICAgICAgICAgIHN1bnNldFN0ZXA6IHRoYXQuc3Vuc2V0U3RlcCxcbiAgICAgICAgICAgICAgICAgICAgc3VucmlzZVN0ZXA6IHRoYXQuc3VucmlzZVN0ZXBcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIEluaXQgdGhlIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgdGhhdC5zZXROaWdodE9yRGF5KHdpbmRvdy5wYWdlWU9mZnNldCArICh3aW5kb3cuaW5uZXJIZWlnaHQvMikpO1xuICAgICAgICAgICAgICAgIHRoYXQuY3ljbGVXaGVlbC5yb3RhdGVXaGVlbCh3aW5kb3cucGFnZVlPZmZzZXQgKyAod2luZG93LmlubmVySGVpZ2h0LzIpKTtcblxuICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgc2Nyb2xsaW5nIGV2ZW50IGxpc3RlbmVyIGJ1dFxuICAgICAgICAgICAgICAgIC8vIHdpdGggdGhlIGRlZmF1bHQgZGF0YXMgc2V0IGluIHRoZSBcbiAgICAgICAgICAgICAgICAvLyBjb25zdHJ1Y3RvclxuICAgICAgICAgICAgICAgIHRoYXQuc2V0U2Nyb2xsRXZlbnRMaXN0ZW5lcigpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXNrIHRoZSB1c2VyIGlmIHdlIGNhbiBnZXQgYWNjZXNzIHRvXG4gICAgICogaGlzL2hlciBnZW9sb2NhbGlzYXRpb25cbiAgICAgKiBTZXQgdGhlIGxhdGl0dWRlIGFuZCBsb25naXR1ZGVcbiAgICAgKi9cbiAgICBzZXRMYXRMbmcoKSB7XG4gICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xuICAgICAgICBpZiAoXCJnZW9sb2NhdGlvblwiIGluIG5hdmlnYXRvcikge1xuICAgICAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihmdW5jdGlvbihwb3NpdGlvbikge1xuICAgICAgICAgICAgICAgIHRoYXQubGF0ID0gcG9zaXRpb24uY29vcmRzLmxhdGl0dWRlO1xuICAgICAgICAgICAgICAgIHRoYXQubG5nID0gcG9zaXRpb24uY29vcmRzLmxvbmdpdHVkZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBiYWNrZ3JvdW5kIGFuZCB0ZXh0IGNvbG9yXG4gICAgICogZGVwZW5kaW5nIGlmIHRoaXMgaXMgbmlnaHQsIHN1bnJpc2Ugb3Igc3Vuc2V0XG4gICAgICogXG4gICAgICogQHBhcmFtIHtmbG9hdH0gcG9zaXRpb24gXG4gICAgICovXG4gICAgc2V0TmlnaHRPckRheShwb3NpdGlvbikge1xuICAgICAgICBpZihwb3NpdGlvbiA+PSB0aGlzLnN1bnJpc2VTdGVwKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZGF5Jyk7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lckhUTUwuY2xhc3NMaXN0LmFkZCgnanMtc3VucmlzZScpO1xuXG4gICAgICAgICAgICAvLyBDaGFuZ2UgY29sb3IgdGV4dFxuICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLWNvbG9yLXRleHQnLCAnIzJCMkIyQicpO1xuICAgICAgICAgICAgLy8gQ2hhbmdlIHJvdGF0aW9uIHdoZWVsXG4gICAgICAgICAgICB0aGlzLmN5Y2xlV2hlZWwuc3VucmlzZVJvdGF0aW9uKCk7XG5cbiAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgbmlnaHQgY2xhc3NcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVySFRNTC5jbGFzc0xpc3QucmVtb3ZlKCdqcy1uaWdodCcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYocG9zaXRpb24gPj0gdGhpcy5zdW5zZXRTdGVwKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbmlnaHQnKTtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVySFRNTC5jbGFzc0xpc3QuYWRkKCdqcy1uaWdodCcpO1xuXG4gICAgICAgICAgICAvLyBDaGFuZ2UgY29sb3IgdGV4dFxuICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLWNvbG9yLXRleHQnLCAnI0Y3RjdGNycpO1xuICAgICAgICAgICAgLy8gQ2hhbmdlIHJvdGF0aW9uIHdoZWVsXG4gICAgICAgICAgICB0aGlzLmN5Y2xlV2hlZWwubmlnaHRSb3RhdGlvbigpO1xuXG4gICAgICAgICAgICAvLyBEZWxldGUgdGhlIHN1bnNldCBhbmQgc3VucmlzZSBjbGFzc1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXJIVE1MLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLXN1bnNldCcpO1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXJIVE1MLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLXN1bnJpc2UnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkYXknKTtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVySFRNTC5jbGFzc0xpc3QuYWRkKCdqcy1zdW5zZXQnKTtcblxuICAgICAgICAgICAgLy8gQ2hhbmdlIGNvbG9yIHRleHRcbiAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1jb2xvci10ZXh0JywgJyMyQjJCMkInKTtcbiAgICAgICAgICAgIC8vIENoYW5nZSByb3RhdGlvbiB3aGVlbFxuICAgICAgICAgICAgdGhpcy5jeWNsZVdoZWVsLnN1bnNldFJvdGF0aW9uKCk7XG5cbiAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgbmlnaHQgY2xhc3NcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVySFRNTC5jbGFzc0xpc3QucmVtb3ZlKCdqcy1uaWdodCcpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGV2ZW50IGxpc3RlbmVyIHRvIGFkanVzdCB0aGUgZGF0YSBkZXBlbmRpbmcgXG4gICAgICogb2YgdGhlIG5ldyBoZWlnaHRcbiAgICAgKi9cbiAgICBzZXRSZXNpemVFdmVudExpc3RlbmVyKCkge1xuICAgICAgICBjb25zdCB0aGF0ID0gdGhpcztcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIChlKSA9PiB7XG4gICAgICAgICAgICAvLyBVc2Ugc2V0SW50ZXJ2YWwgdG8gcHJldmVudFxuICAgICAgICAgICAgLy8gbGFnIG9mIHRoZSByZXNpemUgZXZlbnQgbGlzdGVuZXJcbiAgICAgICAgICAgIHNldFRpbWVvdXQodGhhdC5yZXNpemVGdW5jdGlvbigpLCAyNTApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgZXZlbnQgbGlzdGVuZXIgb24gdGhlIHNjcm9sbCB0byBjaGFuZ2VcbiAgICAgKiB0aGUgYmFja2dyb3VuZCBjb2xvciBkZXBlbmRpbmcgb2YgdGhlIHBvc2l0aW9uXG4gICAgICovXG4gICAgc2V0U2Nyb2xsRXZlbnRMaXN0ZW5lcigpIHtcbiAgICAgICAgLy8gQWRkIGV2ZW50IHdoZW4gdGhlIHNjcm9sbGluZyBtZWV0IGV2ZXJ5XG4gICAgICAgIC8vIDEvMjQgb2YgdGhlIHNjcmVlbi4gMjQgaG91cnMgaW4gYSBkYXlcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIChlKSA9PiB7XG4gICAgICAgICAgICAvLyBDaGFuZ2luZyB0aGUgcG9zaXRpb24gb2YgdGhlIGN1cnNvciBmcm9tIHRoZSBcbiAgICAgICAgICAgIC8vIHRvcCBsZWZ0IGNvcm5lciB0byB0aGUgbWlkZGxlIGxlZnQuXG4gICAgICAgICAgICB0aGlzLnNldE5pZ2h0T3JEYXkod2luZG93LnBhZ2VZT2Zmc2V0ICsgKHdpbmRvdy5pbm5lckhlaWdodC8yKSk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHZhbHVlcyB3aGVuIHRoZSBoZWlnaHQgY2hhbmdlcyBieSByZXNpemluZ1xuICAgICAqL1xuICAgIHJlc2l6ZUZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm9uZVBhcnRIZWlnaHQgPSAoZG9jdW1lbnQuYm9keS5jbGllbnRIZWlnaHQpIC8gMjQ7XG4gICAgICAgIHRoaXMuc3VucmlzZVN0ZXAgPSB0aGlzLnN1bnJpc2VIb3VycyAqIHRoaXMub25lUGFydEhlaWdodDtcbiAgICAgICAgdGhpcy5zdW5zZXRTdGVwID0gdGhpcy5zdW5zZXRIb3VycyAqIHRoaXMub25lUGFydEhlaWdodDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGhvdXIgYnkgYXJyb3VuZGluZyBpZiB0aGUgbWludXRlcyBhcmVcbiAgICAgKiBoaWdoZXIgdGhhbiA0MFxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7RGF0ZX0gZGF0ZSBcbiAgICAgKi9cbiAgICBnZXRIb3VycyhkYXRlKSB7XG4gICAgICAgIGNvbnN0IGhvdXJzID0gZGF0ZS5nZXRVVENIb3VycygpO1xuICAgICAgICBjb25zdCBtaW51dGVzID0gZGF0ZS5nZXRVVENNaW51dGVzKCk7XG4gICAgICAgIGlmKG1pbnV0ZXMgPj0gNDApIHtcbiAgICAgICAgICAgIHJldHVybiBob3VycyArIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhvdXJzO1xuICAgIH1cbn0iXSwic291cmNlUm9vdCI6IiJ9